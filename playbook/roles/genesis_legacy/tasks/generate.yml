- name: Gather validator information
  when: type == "seat"
  ansible.builtin.set_fact:
    validator:
      node_id: "{{ hostvars.validator.ansible_local.daemon.node_id }}"
      public_key: "{{ hostvars.validator.ansible_local.daemon.public_key }}"
- name: Prepare gentx script
  when: type == "seat"
  ansible.builtin.template:
    src: generate-gentx.sh.j2
    dest: "{{ work.path }}/generate-gentx.sh"
    owner: "{{ user }}"
    group: "{{ user }}"
    mode: u=rw,g=r,o=r
- name: Generate gentx
  when: type == "seat"
  become: true
  become_user: "{{ user }}"
  ansible.builtin.shell:
    cmd: sh generate-gentx.sh
    chdir: "{{ work.path }}"
- name: Fetch gentx
  when: type == "seat"
  ansible.builtin.fetch:
    src: "{{ work.path }}/gentx.json"
    flat: true
    dest: artifact/{{ inventory_hostname }}/
